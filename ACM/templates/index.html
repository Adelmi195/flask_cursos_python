{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div class="container text-center">
        <h1 class="fade-in">Análisis de Correspondencia Multivariado</h1>
        <p class="lead fade-in">Descubre patrones ocultos en tus datos categóricos con ACM</p>
        <a href="#que-es-acm" class="btn btn-light btn-lg me-3">
            <i class="fas fa-play me-2"></i>Empezar a Aprender
        </a>
        <a href="{{ url_for('acm_tool') }}" class="btn btn-outline-light btn-lg">
            <i class="fas fa-tools me-2"></i>Iniciar Prueba ACM
        </a>
    </div>
</section>

<!-- ¿Qué es el ACM? -->
<div class="container">
    <div class="info-card slide-up" id="que-es-acm">
        <h2>
            <i class="fas fa-question-circle card-icon"></i>
            ¿Qué es el Análisis de Correspondencia Múltiple?
        </h2>
        <p>
            El <strong>Análisis de Correspondencia Múltiple (ACM)</strong> es una técnica estadística multivariada 
            que permite explorar las relaciones entre múltiples variables categóricas. Es una extensión del análisis 
            de correspondencia simple que trabaja con más de dos variables.
        </p>
        <p>
            Esta técnica es especialmente útil para:
        </p>
        <ul class="list-unstyled">
            <li><i class="fas fa-check text-success me-2"></i>Identificar patrones en encuestas y cuestionarios</li>
            <li><i class="fas fa-check text-success me-2"></i>Analizar perfiles de consumidores</li>
            <li><i class="fas fa-check text-success me-2"></i>Estudiar comportamientos sociales</li>
            <li><i class="fas fa-check text-success me-2"></i>Reducir la dimensionalidad de datos categóricos</li>
        </ul>
        <div class="alert alert-info mt-3">
            <i class="fas fa-lightbulb me-2"></i>
            <strong>Ejemplo práctico:</strong> Imagina que tienes datos sobre preferencias de comida, edad y ciudad de residencia. 
            El ACM te ayudaría a descubrir que las personas jóvenes de cierta ciudad prefieren comida rápida.
        </div>
    </div>

    <!-- Fundamentos Matemáticos -->
    <div class="info-card slide-up">
        <h2>
            <i class="fas fa-calculator card-icon"></i>
            Fundamentos Matemáticos y Conceptuales
        </h2>
        <p>
            El ACM se basa en la <strong>descomposición en valores singulares</strong> de una matriz de indicadores. 
            Matemáticamente, transforma variables categóricas en un espacio continuo de menor dimensión.
        </p>
        
        <div class="row mt-4">
            <div class="col-md-6">
                <h4 class="text-success"><i class="fas fa-cogs me-2"></i>Proceso Principal</h4>
                <ol>
                    <li><strong>Codificación:</strong> Las variables categóricas se convierten en variables dummy (0 y 1)</li>
                    <li><strong>Matriz de correspondencia:</strong> Se calcula la matriz de frecuencias relativas</li>
                    <li><strong>Descomposición:</strong> Se aplica la descomposición en valores singulares</li>
                    <li><strong>Proyección:</strong> Los datos se proyectan en un espacio de menor dimensión</li>
                </ol>
            </div>
            <div class="col-md-6">
                <h4 class="text-success"><i class="fas fa-chart-line me-2"></i>Conceptos Clave</h4>
                <ul>
                    <li><strong>Inercia:</strong> Medida de la variabilidad total en los datos</li>
                    <li><strong>Componentes:</strong> Ejes que explican la mayor varianza</li>
                    <li><strong>Contribuciones:</strong> Peso de cada variable en cada componente</li>
                    <li><strong>Coordenadas:</strong> Posición de cada observación en el nuevo espacio</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Subtemas -->
    <div class="row">
        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-search text-success me-2"></i>
                    Interpretación de Resultados
                </h3>
                <p>Los resultados del ACM se interpretan principalmente a través de:</p>
                <ul>
                    <li><strong>Gráficos de correspondencia:</strong> Visualización de las relaciones entre categorías</li>
                    <li><strong>Contribuciones relativas:</strong> Importancia de cada variable en cada dimensión</li>
                    <li><strong>Proximidad:</strong> Categorías cercanas indican asociación</li>
                    <li><strong>Ejes principales:</strong> Direcciones de máxima variabilidad</li>
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-chart-bar text-success me-2"></i>
                    Métricas de Evaluación
                </h3>
                <p>Para evaluar la calidad del análisis utilizamos:</p>
                <ul>
                    <li><strong>Varianza explicada:</strong> Porcentaje de información conservada</li>
                    <li><strong>Inercia total:</strong> Variabilidad total en los datos</li>
                    <li><strong>Calidad de representación:</strong> Qué tan bien se representa cada punto</li>
                    <li><strong>Eigenvalues:</strong> Importancia de cada componente</li>
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="info-card slide-up">
                <h3>
                    <i class="fas fa-balance-scale text-success me-2"></i>
                    Ventajas y Consideraciones
                </h3>
                <p><strong>Ventajas:</strong></p>
                <ul>
                    <li>Maneja múltiples variables categóricas</li>
                    <li>Reduce dimensionalidad</li>
                    <li>Visualización intuitiva</li>
                    <li>No requiere distribución normal</li>
                </ul>
                <p><strong>Consideraciones:</strong></p>
                <ul>
                    <li>Sensible a categorías raras</li>
                    <li>Interpretación puede ser compleja</li>
                    <li>Requiere muestra suficiente</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Minijuego -->
    <div class="game-container slide-up">
        <h2 class="text-center mb-4">
            <i class="fas fa-gamepad me-3"></i>
            ¡Aprende ACM Jugando!
        </h2>
        <p class="text-center">Simula cómo el ACM agrupa datos similares. Selecciona elementos que crees que están relacionados:</p>
        
        <div class="game-board">
            <h4 class="text-center mb-3">Datos de Personas: Edad, Ciudad, Hobby</h4>
            <div id="game-data" class="text-center">
                <div class="data-point" data-group="jovenes-madrid-tech">Juan (25, Madrid, Programación)</div>
                <div class="data-point" data-group="jovenes-madrid-tech">Ana (22, Madrid, Videojuegos)</div>
                <div class="data-point" data-group="adultos-barcelona-cultura">Carlos (45, Barcelona, Lectura)</div>
                <div class="data-point" data-group="adultos-barcelona-cultura">María (40, Barcelona, Teatro)</div>
                <div class="data-point" data-group="jovenes-valencia-deporte">Luis (28, Valencia, Fútbol)</div>
                <div class="data-point" data-group="jovenes-valencia-deporte">Sara (26, Valencia, Tenis)</div>
                <div class="data-point" data-group="adultos-madrid-cultura">Pedro (50, Madrid, Música)</div>
                <div class="data-point" data-group="jovenes-barcelona-tech">Elena (24, Barcelona, Programación)</div>
            </div>
            
            <div class="text-center mt-4">
                <button id="check-game" class="btn btn-success btn-lg">
                    <i class="fas fa-check me-2"></i>Verificar Agrupación
                </button>
                <button id="reset-game" class="btn btn-outline-secondary btn-lg ms-2">
                    <i class="fas fa-refresh me-2"></i>Reiniciar
                </button>
            </div>
            
            <div id="game-result" class="mt-3" style="display: none;"></div>
        </div>
        
        <div class="alert alert-info mt-4">
            <i class="fas fa-info-circle me-2"></i>
            <strong>Objetivo:</strong> El ACM identificaría automáticamente estos grupos basándose en las similitudes 
            entre edad, ciudad y hobbies. ¡Intenta agrupar elementos que tengan características similares!
        </div>
    </div>

    <!-- Botón principal -->
    <div class="text-center my-5">
        <a href="{{ url_for('acm_tool') }}" class="btn btn-primary btn-lg">
            <i class="fas fa-rocket me-3"></i>
            Iniciar Prueba ACM
        </a>
        <p class="mt-3 text-muted">¡Comienza a analizar tus propios datos ahora!</p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const dataPoints = document.querySelectorAll('.data-point');
    const checkButton = document.getElementById('check-game');
    const resetButton = document.getElementById('reset-game');
    const resultDiv = document.getElementById('game-result');
    
    let selectedGroups = {};
    
    dataPoints.forEach(point => {
        point.addEventListener('click', function() {
            this.classList.toggle('selected');
        });
    });
    
    checkButton.addEventListener('click', function() {
        const selected = document.querySelectorAll('.data-point.selected');
        
        if (selected.length < 2) {
            showResult('¡Selecciona al menos 2 elementos para agrupar!', 'warning');
            return;
        }
        
        // Verificar si los elementos seleccionados pertenecen al mismo grupo lógico
        const groups = {};
        selected.forEach(point => {
            const group = point.dataset.group;
            if (!groups[group]) groups[group] = 0;
            groups[group]++;
        });
        
        // Calcular puntuación
        let score = 0;
        let totalSelected = selected.length;
        let perfectGroups = 0;
        
        for (let group in groups) {
            if (groups[group] >= 2) {
                score += groups[group] * 10;
                perfectGroups++;
            }
        }
        
        if (perfectGroups > 0 && Object.keys(groups).length === perfectGroups) {
            showResult(`¡Excelente! Has identificado ${perfectGroups} grupo(s) correctamente. Puntuación: ${score}`, 'success');
        } else {
            showResult(`Buen intento. Has agrupado algunos elementos correctamente. El ACM haría esto automáticamente analizando todas las variables.`, 'info');
        }
    });
    
    resetButton.addEventListener('click', function() {
        dataPoints.forEach(point => {
            point.classList.remove('selected');
        });
        resultDiv.style.display = 'none';
    });
    
    function showResult(message, type) {
        resultDiv.innerHTML = `
            <div class="alert alert-${type === 'success' ? 'success' : type === 'warning' ? 'warning' : 'info'}">
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                ${message}
            </div>
        `;
        resultDiv.style.display = 'block';
    }
});
</script>
{% endblock %}